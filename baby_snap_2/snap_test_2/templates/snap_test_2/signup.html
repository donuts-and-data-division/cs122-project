{% load static %}<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Trying AJAX</title>
  </head>
  <body>
    <header> </header>
    <main>
        <form method="post">
            {% csrf_token %}
            {{ form.as_p }}
        <button type="submit">Sign up</button>
        </form>
      <a href="https://simpleisbetterthancomplex.com/tutorial/2016/08/29/how-to-work-with-ajax-request-with-django.html">Code from here.</a>
    </main>
    <footer> </footer>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <script>
        $("#id_username").change(function () {
          console.log($(this).val());
          var form = $(this).closest("form");
          console.log(form)
          $.ajax({
            url: form.attr("data-validate-username-url"),
            data: form.serialize(),
            dataType: 'json',
            success: function (data) {
              if (data.is_taken) {
                alert(data.error_message);
              }
            }
          });

        });
    </script>

  </body>
</html>

